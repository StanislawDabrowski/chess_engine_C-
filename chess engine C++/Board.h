#pragma once
#include <vector>
#include <string>
#include "MoveRecord.h"
#include "MoveGenerator.h"
#include "StaticEvaluation.h"

typedef uint64_t Bitboard;


class Board
{
private:
	MoveRecord moves_stack[1<<20];
	uint16_t moves_stack_size = 0;

	//hardcoded
	uint64_t zobrist_pieces[2][6][64] = {
		{
			{
				0x028eb140c876d933ULL, 0x8229f435e328a4bcULL, 0xb1574c39e785f0edULL, 0x650fcbcca386e8feULL, 0x05bbd95a044c9e3dULL, 0x9c30e4900732dc4eULL, 0x9232f1934e54a25eULL, 0xf83ff09e7e5e3486ULL,
				0x0a6c2b19152b3331ULL, 0x05140e16e08a361dULL, 0x057d266be4fc2fa7ULL, 0xa2df9fcd6f751158ULL, 0xb360a5fb0b20fac0ULL, 0xdeb089ea73823353ULL, 0x0f4e88155fc0e8a7ULL, 0x2f9716de404428c9ULL,
				0x884189841732043dULL, 0x0777fda9dbd48d73ULL, 0x069a073af4ed8053ULL, 0x9126fdf956d58955ULL, 0x8959f16902d89161ULL, 0x271ac06c50a0c40fULL, 0x94e3baaf0b7d17a8ULL, 0x82abbc2e3b09a8e5ULL,
				0x753e41a3f588eabfULL, 0xf167075364de3867ULL, 0xede2dd42a90ee82fULL, 0xb81059c95bd97d26ULL, 0x67daefe4fdc7c0aeULL, 0x353c125a08e89455ULL, 0x023af9ea00196907ULL, 0x4669054194006eccULL,
				0x20ada34c5e36af9dULL, 0x2ac29152059823a3ULL, 0x0b1cbd11f119976aULL, 0x00601acebf54ee47ULL, 0x82e473e459c56e49ULL, 0x957283cb0bfc9124ULL, 0xefbb6e60435d9ec0ULL, 0x7f0bcddd92c76eedULL,
				0x3ba0c497289e77fdULL, 0x3b2455d5ee381325ULL, 0x2caeeaf02c3e4fb3ULL, 0x86297fc1f1bf6a60ULL, 0x8ddf43cfc419aab0ULL, 0x86e92cde8a3cf0ebULL, 0xa427644bd4c55791ULL, 0xdcedfb16e5c750a1ULL,
				0x58af9a55c33a140cULL, 0x62a09afddff9a448ULL, 0xbf322e651001ca57ULL, 0xe4e2c0acb670f200ULL, 0xa45583773ef18d18ULL, 0x4deecae994dee3d9ULL, 0xf8ad00c74f0fc20aULL, 0x7a8dd239157a13e3ULL,
				0xc1efe7f8435c04bfULL, 0x2419f6f6a48c6d59ULL, 0xc0e99f5815e3775eULL, 0xc43faf6b68b97480ULL, 0x82dd2a3033aa6fddULL, 0x5d932e444d8c39e0ULL, 0xf3cb3e6f37bd7563ULL, 0x3d3069a71c0a37b5ULL,
			},
			{
				0x078673a22758b9a9ULL, 0x87d331e852dd98e7ULL, 0x04acafd7570c2512ULL, 0xa12e8903d47ce055ULL, 0xb57a901cc295ef6aULL, 0xe31fa2e85d5f0713ULL, 0x43531ad6220ed1cdULL, 0x54a5bf404d0c9941ULL,
				0x48343806fe5bc4fbULL, 0x4c5b266ee3062a35ULL, 0xf2f11cd2b25050eaULL, 0x1b106c7c9a181e7fULL, 0x85e81ac10150b131ULL, 0xdc58859f91b6537cULL, 0xbcdd993a074f97fbULL, 0xe752edffe78273bbULL,
				0xe1ab60675d2f9baeULL, 0xf2ff662b5b9a9619ULL, 0xf6a4708579423bd7ULL, 0x8ad33f1b7566c0bbULL, 0x75aca2b223ae759cULL, 0x3e8cc7bc782b776fULL, 0xe544277f1a090d7bULL, 0x2d65f559703ae179ULL,
				0xa4f639b076652fb1ULL, 0xb845b0e727ef2c0cULL, 0xd99350423c834d7fULL, 0x86159a38c2cdd703ULL, 0x24bca2074b9f6edaULL, 0x771affe58b18cc1fULL, 0x6937954e45e7bb8dULL, 0x0507bfd5e086d184ULL,
				0xae1526af41c553c2ULL, 0x14a93025ae2b7b9dULL, 0xcc18992412261c55ULL, 0x6cd998a6a980a38fULL, 0x9eb9f1b468f5ba1dULL, 0xc633ec86a3dc32ebULL, 0xf97a90b70c54ad9cULL, 0x080449abe8a339a5ULL,
				0x4ed923c03d8b2cd6ULL, 0x88f4820bcfdcfa14ULL, 0x23eae988f1b69195ULL, 0xcd7300bbcc8e0aaaULL, 0x3654116d39afb9acULL, 0x9a566d4c7fdcc9f9ULL, 0x19a03d84bafbe701ULL, 0xbdaf8db8dd14602eULL,
				0x84aa44b4498d9cf4ULL, 0xd133f5c91d1b300cULL, 0x5d254dfaa7d93ad9ULL, 0xf796b0aac02e203bULL, 0xfb0f954a78a2d589ULL, 0xfcce2d10c715ffd6ULL, 0x6a591f25f95d1295ULL, 0x0e9ecd9771890da0ULL,
				0xbac832a426a71238ULL, 0x6d24dfe928c0bddeULL, 0x20fd1799981216f9ULL, 0x2f5c88b20a058d1dULL, 0x9419567c0344b9feULL, 0x187649a123be766eULL, 0xa79513c7ff80e39fULL, 0x4e7abaca89f87286ULL,
			},
			{
				0xa874d276ee87c1b3ULL, 0xcee2036c0fe7ea7eULL, 0x6b1279d4367fa87bULL, 0xa41a97222b9b4b2eULL, 0x7c5deade20e59e45ULL, 0x2354c9e8ec856ca7ULL, 0x8645f2856b91766bULL, 0x76b3192536441a85ULL,
				0xe626a64f3e842e7dULL, 0xd44e394357886ff6ULL, 0x2a930d45be6288d7ULL, 0xbdddd1ba2fae29f4ULL, 0x39056af196b6d294ULL, 0x1123d8db94930f32ULL, 0x3447829647a408c3ULL, 0x876b7ca114f13593ULL,
				0x13921b3ab21012fdULL, 0x4b7fd96f7ac0ddbdULL, 0x93b150baac59d574ULL, 0xdb221878a0be0c5aULL, 0xc2913530a6aa6986ULL, 0xcf24318aa04f7b20ULL, 0x178cd45faa7d4dd3ULL, 0x1cfb8dca419cff36ULL,
				0x71e4da8a0d4bb66cULL, 0x04f6e52872c51dc9ULL, 0xc6967152c96be451ULL, 0x7723d4679f0a12e8ULL, 0xb1e8c81792a600d0ULL, 0xc48e12c4620f7207ULL, 0xd2e526ca796f0abbULL, 0xca6a2ce62f22b2acULL,
				0x5ecd73e5188aa1dbULL, 0x22fb2cf0ec813c00ULL, 0x33d5a865c46e98d8ULL, 0x0ac5c6ea9f2cb111ULL, 0x3bb1f0a414a0049bULL, 0xa97246da220a84c1ULL, 0x685e659251f0b93aULL, 0x2699997e8d60d6e2ULL,
				0x54fbf36df505152cULL, 0xc4cf1ce41f715c1cULL, 0x5212c7391c0156cfULL, 0xa248a526449fff98ULL, 0x518892bf2ca7641eULL, 0xbba8a25317360f7eULL, 0xf0b91f79285c56e0ULL, 0x27b7567d1d5e2c6eULL,
				0xba518a5437334635ULL, 0xc5a3946f2c4cb367ULL, 0x8f7c4fbd0e884a2cULL, 0xe7070a89b61f0a05ULL, 0x84b6692ac8a1950fULL, 0x40b8c576b84bd0b5ULL, 0x1d464a77729b91feULL, 0xa36b6269b32ec63aULL,
				0xb7afb09252580721ULL, 0xcf0a30ec02000389ULL, 0xf2c01137acc4e5cbULL, 0x19ef5c05b7634cbcULL, 0x1f7803db869739b1ULL, 0x8af4eb64d159c7ebULL, 0xa6d20f4a09dc4fe9ULL, 0xe4b462880b08f1d4ULL,
			},
			{
				0xb7040d9266c3b472ULL, 0x68862248c9384e06ULL, 0xa3fb2ab1c5f1ff96ULL, 0xcf336e4ab4ad7b14ULL, 0x48378a1c51468777ULL, 0xbdad85890869b655ULL, 0x99769e7215cb9a64ULL, 0x6916a887b4360f42ULL,
				0xfc0a85a86baf5abcULL, 0x2b08ff1d987ddbedULL, 0x86a86857e81d4d05ULL, 0x70eed362958182d8ULL, 0x0ad456a293d49bebULL, 0x98d4b535e592485aULL, 0x4f10d3387f734518ULL, 0x76e37f5153ce2356ULL,
				0x0e9c7cac4c0e43b7ULL, 0x1831433d6d6b3ca7ULL, 0xb3538da57d9cf97dULL, 0x1d36b883523774ecULL, 0x81f23ea76589a940ULL, 0x598b64859a14a69bULL, 0xf372d37e6559faadULL, 0x558dff2d1b697b16ULL,
				0x88e383f1a1c3a988ULL, 0x889f398720e1dd86ULL, 0x13c3e317f970fe7dULL, 0xa245b70a7ceaaca7ULL, 0x0a51e693eeda8fc6ULL, 0xeae536336054a9b3ULL, 0xb4d63a0c60a5203bULL, 0x94bca32fe99d1cd4ULL,
				0x5df1618f0aec69ddULL, 0x97dd6f0f71e681c8ULL, 0x02be8f01a6c5f0c0ULL, 0xaad47ac76fb9aef6ULL, 0x310e31c124d9506cULL, 0x2c9cc4988ed3f796ULL, 0x2753ba70c0ba65bbULL, 0xaf4a0339218fe408ULL,
				0xe3c1d34b30295decULL, 0x3834c276f4fce502ULL, 0xf6ff8c23fee0fbf6ULL, 0xe5381c41fb3a0de6ULL, 0xd6c107727d2f938bULL, 0x7a21c3d49154ebedULL, 0x9fd11a3b95fcb51aULL, 0xec346a052e3e4910ULL,
				0x8d879a5041e5d57fULL, 0x5891e4fce6c0aaacULL, 0x54fd79f91544a15eULL, 0x07be692511ccae07ULL, 0xff83c8a126a08176ULL, 0x8b883eff0bd8378bULL, 0x43223f6be17f6082ULL, 0xdc73ae3c12af17edULL,
				0xe4629df86a64cbbcULL, 0x9cda7b88e24ace5aULL, 0xe7767d7def94663fULL, 0x701e66026a9d70b3ULL, 0xea5f348c4ea98a5aULL, 0xa82a4ee83ceccdafULL, 0x68f2483a6034511dULL, 0xd77be83fd1c1de85ULL,
			},
			{
				0x3c2b524364dc0a8dULL, 0xa1ef29b61f429a5eULL, 0x0db553eae307e1cdULL, 0xe1e79866c0293abbULL, 0x7e849d35d44e3df0ULL, 0xc5cd649d0ed528ceULL, 0xa8f7cedb41929477ULL, 0x0e2c0d1277897d6bULL,
				0x65ba3c06837983ffULL, 0xe10f5380180b2c9fULL, 0xfbdd64e97a6dfb38ULL, 0xcb9138106557bdc9ULL, 0x0917e5d149f116bfULL, 0x4a1f3183fd8b1257ULL, 0xe16e3f8c72175d1aULL, 0xb189b33927406fa0ULL,
				0xd3c10651505f8894ULL, 0xf333ed98545014f0ULL, 0x9c358b526a435ef2ULL, 0x9a0d12181e8b1e38ULL, 0xefa4070f4f8cd710ULL, 0xed8950bd9347c8e7ULL, 0x3a95bfd73e21227dULL, 0xa6eda315bc9f54adULL,
				0x110fc7451983de6cULL, 0xec498555e0e07415ULL, 0x904490104e6d7bd4ULL, 0x9518f87cc9fb04f5ULL, 0x8796d022ca7e43cbULL, 0x06b10cd40cdc02a4ULL, 0x5659a4c53eab8e61ULL, 0x0eb286a7941c1d69ULL,
				0xa6cda81565e56c99ULL, 0x9a868614c4cd5d4eULL, 0xa50f67df8cfee099ULL, 0x693dfb7598bdc025ULL, 0xc5c883bb8f87f80aULL, 0xe7b94c391df50f98ULL, 0xe134f133a3389e86ULL, 0x6c3751675dcf2f51ULL,
				0xb1da672d3784ef39ULL, 0xdff1317401c6edc8ULL, 0x4df3c04631d036ffULL, 0x1fbd4b189420c749ULL, 0x098a778e38879f0eULL, 0x991fa426998df94aULL, 0xab3cd6197fb1079fULL, 0x37510d6a63fbc6ecULL,
				0x502dd5927ff70437ULL, 0xc0e666978e639f7cULL, 0x4e8b4e7df1062087ULL, 0x62a01a0cb17e4520ULL, 0x06168cbdce8cebd0ULL, 0x8701a46ea30f5d75ULL, 0x5735d6964d5273cbULL, 0x0bd933d523de2c08ULL,
				0x75fd09d3fbc3ab31ULL, 0x9d6a441a535fc9a6ULL, 0xdb390a3d2864b16dULL, 0xa76fd5207457b6c8ULL, 0x4208b1805f333fc9ULL, 0x70f86f80adb3ab07ULL, 0xa5de22ccc3ef3c61ULL, 0x60c125b203d5a01dULL,
			},
			{
				0xa70bdb66caa2a79fULL, 0xf127f2e000da31dcULL, 0x7241e32729016255ULL, 0x07420e388a34724aULL, 0x9b1082985719581cULL, 0x03aed1ed01ec44e3ULL, 0xa84e7aa2b851988aULL, 0x294a105c7009d185ULL,
				0x694c3a0fdcde9a4cULL, 0xba502a0129e2d27aULL, 0xd02c8a4dc9300b3eULL, 0xe6e022b2806a53f6ULL, 0xe9c2687c53c0313aULL, 0x2c4524272cfc61c3ULL, 0x7c8f1ffe20a577c8ULL, 0x271ca985c3c16f87ULL,
				0xd95c50a31e761f0fULL, 0x9f425ab3b74bd709ULL, 0x6202d5ec10510c7dULL, 0xd46159e156b23243ULL, 0x583be0ce7e4b21acULL, 0x179acd10cc7d2c9fULL, 0x1012a63a2b8ac428ULL, 0xffa578301910d19cULL,
				0x6a2c63a4a6a0c2e3ULL, 0x50ddf7f25a92ef0fULL, 0xd570711c55c380a4ULL, 0x6c5fc8fa3cfc6a4bULL, 0x82263dcdb8a8c82eULL, 0x6f1b918acd82ed98ULL, 0xe986a68b7ff5e4cfULL, 0xfc130b6255aa56fbULL,
				0x7467c1523d2d3718ULL, 0x6a6ba6e295367e89ULL, 0x3b972692826fe47aULL, 0xa588073765e14af9ULL, 0x9038ab02b8f0c261ULL, 0xc014168b443dfceeULL, 0x727c58a3a231f02dULL, 0xf962bfb3a76cf82cULL,
				0x586a51a011b9d8ebULL, 0xb9e5333fb4ae4833ULL, 0x45cad15e52bf995cULL, 0x29a10184acff5780ULL, 0x034c296c3aafb759ULL, 0x35b67406023a6982ULL, 0x5d763a885db77fc1ULL, 0xc6f625d4d7eb743fULL,
				0x642df2b4385ecde7ULL, 0x7f91c78ccc98197fULL, 0xca9a720f704b119dULL, 0x8c81a22c5cb20da4ULL, 0xdd0c988c979cf2bdULL, 0xdca223c76c9ac23fULL, 0xd1eb096cf242bca5ULL, 0xbdd88ab9feee2c58ULL,
				0x16ee1de912a3898eULL, 0xb04cac2fabb3fd0fULL, 0x1a48a3c434599d36ULL, 0xf0866251120876f9ULL, 0x1a40faa5fc692b7aULL, 0x9c5397b4989e39c9ULL, 0xfdeb78e94b2e7ec4ULL, 0x4f742eb524357bf7ULL,
			},
		},
		{
			{
				0x3b0ef07f7e88edcbULL, 0xf9ab4111ea9efaf9ULL, 0xc466addc5236f980ULL, 0xadf4ec2120f388edULL, 0xfd8ff14cdd0388b3ULL, 0x1ce406447c315612ULL, 0xe0fc6179274d4753ULL, 0x32a4b2ad6f861d32ULL,
				0xf2615391a2758dccULL, 0x7c40472d612e8156ULL, 0x09449d282826ef11ULL, 0xea93111963b6669dULL, 0x7d7b49313c7304fbULL, 0x55a4ae9c4b683ce7ULL, 0xb1f8858ef8ae1c7cULL, 0x5a335245f3c17c32ULL,
				0xef58dc9010e32898ULL, 0xdb0694d5952f5e36ULL, 0x8e4fcf3cd103e006ULL, 0x2c8a798fd3249a7eULL, 0xc2b99c395048741bULL, 0xfded5f5989586788ULL, 0xb427b8437b707bc6ULL, 0x70fb1cc56de80a4aULL,
				0xc85a152d87adbc8aULL, 0x24b8e0cdacf3bab8ULL, 0xf80645a0eeceeb34ULL, 0xd83ede60d88615e0ULL, 0xa8d545faaa601548ULL, 0x5e6b5987c013c513ULL, 0x1acd561e2037b7f4ULL, 0x9bb80ef991c4f982ULL,
				0x3e3badf60ff1e554ULL, 0x0c2e4b577e223d97ULL, 0xc5769bc212acb90bULL, 0x31a3ecf8670c1edbULL, 0x174566e0fd80e56fULL, 0x37fa0296bd684952ULL, 0x93090820723d2306ULL, 0xcfcd6f1ff7422af0ULL,
				0x2958dc7be70fbad5ULL, 0x13d545ff7cca250fULL, 0x6d7a98c6fcf36a15ULL, 0x5fb34e77accfc65bULL, 0x04e3031d222af284ULL, 0xab3ded7b6ca45dceULL, 0x8c53bfcf04a7d22aULL, 0x4a58d38597883d80ULL,
				0x3f1bd81bb784caedULL, 0xd3ccf36d8e447a30ULL, 0x7597c67b7498e9beULL, 0x9ec725f851c9156fULL, 0xa0d0c0d6cac474b9ULL, 0x3d6741c2b2a13894ULL, 0xc2b791ff05e4fb7bULL, 0x3f84a5701f7bf976ULL,
				0x8906de3cbec68e1cULL, 0xaa6f829b76479f15ULL, 0xb4a9706f9650120fULL, 0x507eaeca6fffd37cULL, 0x47ca272f9659ff40ULL, 0x6bec6f66acf87759ULL, 0x66d4c0a6ee0c4d91ULL, 0x1ef45c269bb34d3aULL,
			},
			{
				0x997cbbabba992163ULL, 0x0675a838003f7b53ULL, 0x1a36152bb52e4becULL, 0xbef2514d0220b861ULL, 0xbb16f639c90a6dd4ULL, 0xf71b4f090da492cbULL, 0x9f6717a26b3be668ULL, 0x19b761bfe31095e2ULL,
				0x9412e82fd77711eaULL, 0x2d5dbbda631557c8ULL, 0x60aa597783d6ed5eULL, 0x87c2c98a371f8403ULL, 0xf55454ec809b9f2aULL, 0x3eb69db5f7fcf5fdULL, 0x7cb220c8dc94d202ULL, 0x3230c0aecc68cd19ULL,
				0x67b0dc62fee1a29cULL, 0x4001dc1f661e8f02ULL, 0x3312330a38b8091bULL, 0xbf63267d6e32eca1ULL, 0xafd998a57696cf3fULL, 0x461bf64888a23a01ULL, 0x9290704e1cbd208cULL, 0x1c45343333245bf4ULL,
				0xaf8a0bb799312a00ULL, 0xbc0ca49b8e28cc55ULL, 0x27cca647b830fd0dULL, 0x285e6b48006552c8ULL, 0xf0dc6554c0a3ff2cULL, 0x41e42cf1db8cb2f0ULL, 0xcf760582b08520f2ULL, 0x44d87ff45564e46eULL,
				0xf44fad3e02d773c1ULL, 0x7dceb8f47afffce9ULL, 0xb5a6e67a849429f7ULL, 0x9424404915382e0fULL, 0xf7de3f8f544cd9a7ULL, 0x7fd84e5186e0c4d0ULL, 0x3a66f6c730b0fefcULL, 0x935be543e4d63801ULL,
				0xa52563a71ad5768cULL, 0xaf60c7b116e44eb9ULL, 0xca329e8aa15a8c9fULL, 0x317e64c633e50e28ULL, 0x72c2c0f0e93de31eULL, 0xc7034c4519c5adf1ULL, 0xa52f70cc722c7ad9ULL, 0xb68bc037fcb100b0ULL,
				0x1a70b17b888d0c83ULL, 0xc7b7c8b4b5f3e0bdULL, 0x8febb286c1e52eacULL, 0xbaba1a4ff2ae5635ULL, 0xdb2ef99427252f50ULL, 0x4d76612befdee27cULL, 0xc7687a008d6efbdeULL, 0x5fa55cbe6858c3ceULL,
				0x6f9013c3790a44ceULL, 0x9b30c7f43420443dULL, 0xc337b05bc1b404b6ULL, 0x2a93016c78222f00ULL, 0x356b432659c6d5c6ULL, 0xef99588c41c05b70ULL, 0x542a50bab39f002dULL, 0x305d0574f0e45cc9ULL,
			},
			{
				0x53ea7f56a9fad36dULL, 0xf19a236f3766a01bULL, 0x0b5f2e860e8713f8ULL, 0xac7a16f6c3e7d2d1ULL, 0xc694145136dd5cd9ULL, 0x815cc79848aa1364ULL, 0x5c7db93ba2f80eaaULL, 0x2d5a30a269ced39eULL,
				0x399b8829ae6eb002ULL, 0x780cbecaba82fbc8ULL, 0xd1409aeceb8eca46ULL, 0x196268dc174e653cULL, 0xf79634f62653e42bULL, 0xb9bdf00c47fc4b4eULL, 0xb287d8d65fc6a5bfULL, 0xd68652d83e86a2b1ULL,
				0xd13654caed7ee69eULL, 0xcc65e245ce0caeddULL, 0x94945701b2df4619ULL, 0xed233b1451f9c08aULL, 0x1e54d73ab68e3de3ULL, 0xdd83bec4ab5f223fULL, 0x9690c6a2c7c9dab1ULL, 0xd40141f219b44937ULL,
				0x07137e1a99a1d19fULL, 0x841d21416ab2442dULL, 0xc8c10476ae8403a4ULL, 0x2ebf41815c0b9381ULL, 0x7deba194565d7183ULL, 0xf83904f09b02a830ULL, 0xc2cb31d647adc31aULL, 0xd5b8dbdecc2a349dULL,
				0xca1000e95041c90cULL, 0xf9fbf0b97b906374ULL, 0x05a482ae9ad61fdfULL, 0xb24b712131dfb98cULL, 0xcec01bd28573c0e8ULL, 0x3e09fe87c55d4c51ULL, 0xf96eb9cffd793310ULL, 0x2c64a8a5ef79321aULL,
				0x8f23d208197a375eULL, 0xdeda87a0f76c404eULL, 0x2d207ee7da8370a9ULL, 0x6f685e2ba5b0a3b2ULL, 0xe33e9d1e322999f4ULL, 0x345a27d38b8bfa44ULL, 0xcf8c613e779f6502ULL, 0x2a789acb0370c913ULL,
				0xe36ce726f482deabULL, 0xc5095dff6ea3cb2fULL, 0x04daeb9841dd825dULL, 0x688d1dd50da114d6ULL, 0x316fcdba4fed81e4ULL, 0x6a12f730c13f6a8aULL, 0xbf103f9140251698ULL, 0x0cbb94665d88f38bULL,
				0x4f2661d392b24991ULL, 0x2e835bf267d33e60ULL, 0xc66a90d6df7c800fULL, 0x1cf694808b178970ULL, 0xa119591807ad817aULL, 0x7f2e698f85c5c1e0ULL, 0xb2b89923b374a8d7ULL, 0xbb42df960fd22eafULL,
			},
			{
				0x2926c905b935d624ULL, 0x6cb46871c95a7a58ULL, 0x55d6098379e997aeULL, 0x0ddef8fbe0cbcf93ULL, 0x5b28901cf32a2a60ULL, 0x4bbffc5c1a86c030ULL, 0x34730d685cb1a50fULL, 0x735a899ef9e476faULL,
				0x6926bef0302459a6ULL, 0x87160223494ee301ULL, 0x3e28541aed56a3e5ULL, 0x77bd7434ff4dc459ULL, 0x249746d67d2ce429ULL, 0x3923125f535c69a3ULL, 0x726dae95ff1e73a5ULL, 0xe02997b83f821dd4ULL,
				0x67782468a109a6b7ULL, 0xf102111a4038a4baULL, 0x451600b1b8feea27ULL, 0xc6e3bfb8a24e5632ULL, 0x4fdde1a9abc1254eULL, 0x1c7484259b9d6341ULL, 0x92934acd98417addULL, 0x24b1487ffc6299cfULL,
				0x1ab483d794d3ab8cULL, 0x0bde6906c8954eb2ULL, 0x4a69aa2e458464c5ULL, 0xf35dbdee453fb2fbULL, 0x1b432836760040f7ULL, 0xe7edf90e864dd0eaULL, 0x630983fa01db0f03ULL, 0x0ada6aced9aa0542ULL,
				0x68fa2c549ba48518ULL, 0xf3d2cf9b2e1b1b98ULL, 0x39cdd92d68e54697ULL, 0x45945ec81cf91451ULL, 0x040b187baea4483eULL, 0x8a5c58423cda6121ULL, 0x3d3126164006cd82ULL, 0xa79a49486d3369a1ULL,
				0x406be58bffdaf083ULL, 0x1b69b78e46e9ec42ULL, 0x07362c8303dfc5a9ULL, 0x5f022797f153e46fULL, 0xc79f33e4878e5ceeULL, 0x8af93f7deb8a57eaULL, 0xa535041e67e301f4ULL, 0xdff9966f66bbdd9dULL,
				0xaeed3c35eeee6bf2ULL, 0x93f26846f78c110eULL, 0x11a7f38509afe45fULL, 0xca7d0209dd3a4fa7ULL, 0x36e0d12ca73c0e85ULL, 0xeb1cd2ce9aaa9e4bULL, 0x9003fb73c4ba1c3aULL, 0xc9001a5fc51d6949ULL,
				0x18c25dcb535df357ULL, 0x1f50fdf262dd656bULL, 0xba7bf3ecc86d94bbULL, 0x2ec9282da013328fULL, 0x8259498bd8803995ULL, 0xf4ceadfba972069bULL, 0x0624db5666b9c2ccULL, 0x7b6215d0aab5d926ULL,
			},
			{
				0xe9d69a7c705f143cULL, 0xd39d2714b6a85911ULL, 0x2aa0fb12a9e0b88fULL, 0x31a779da8f517f78ULL, 0x716c0e448c250aa1ULL, 0xe883e3a5641f8b92ULL, 0xba9ca1802376fe4bULL, 0xe048aa071c484886ULL,
				0x98a120175e60e1b8ULL, 0xcb79cc126f525aa5ULL, 0x92c0ccb727161762ULL, 0xb95179cda1ee855bULL, 0x6ed4400f5402a2caULL, 0x30e26196ad1bba24ULL, 0xccb2db6eed5e2facULL, 0xf8c9dc19398ca3e5ULL,
				0x1af31ba78985206aULL, 0xb3a60e090039fdbdULL, 0x6e05cf9ac6a47e1aULL, 0x0564a453d14483f3ULL, 0x73c3eb1c21b72fb2ULL, 0x3e6067a4cf01b057ULL, 0x1bb94735605c33cbULL, 0xf0550ff17dc5ca30ULL,
				0x14b51ff383cc8731ULL, 0x3c0a04d6ab178492ULL, 0x843725004bb35464ULL, 0x1cd917c16c8c6304ULL, 0x86983b74805ef7a9ULL, 0xd8abc7a8a770d4f7ULL, 0x73799f403ab31c5bULL, 0xd54f644f003c8d6cULL,
				0x1fae424e4e9ab3c5ULL, 0xc83669c23a122c92ULL, 0x5b70a08eb7a14ea0ULL, 0x342d0b7a13dc61cdULL, 0xb6a56cc2ae39662aULL, 0xd921c9064b727aabULL, 0x658dc77448b0e357ULL, 0xa91cacad40717a1bULL,
				0xc0200c981934038eULL, 0xe5c1385d46e9bab1ULL, 0x4e989c076e1e4d8bULL, 0x7771a8c8a69b5048ULL, 0xae5daa0c19590ec2ULL, 0xfdda2f1acbd08d5cULL, 0xf457e65d9e92c598ULL, 0xf53f54f6e2b0f81fULL,
				0xdf1d28effb9f4224ULL, 0xd3f6710e7877ab35ULL, 0x6b153a1d051b66dbULL, 0x526a47012f1e7fb1ULL, 0x2096d70e98cdc7b9ULL, 0x73abab3c184a180bULL, 0x7349ef2349211b01ULL, 0xde9b047dc8ff3e07ULL,
				0x44746b0b2475513aULL, 0x66322f670706ca39ULL, 0x922f4d0245272f08ULL, 0x98f86970d4cc4a2aULL, 0x6ac4cad7b3077682ULL, 0x261daa819033a2f7ULL, 0x1e2af51b670f3a88ULL, 0xd58734012c824f66ULL,
			},
			{
				0xbd325cfb6372993bULL, 0xe04e541fbdb8b766ULL, 0x30fa44b1643facd5ULL, 0xb9c8746786dcbce1ULL, 0xb003da3a19075a76ULL, 0x4506eaec84623627ULL, 0x88545ce12d2e0c43ULL, 0x81b36dbf257a08efULL,
				0x0f5d998941b1b7ecULL, 0xca509694faf76082ULL, 0x264cccd78f5113d5ULL, 0x1386bf33c393a162ULL, 0x24d8c672ab8587c6ULL, 0x557a3e37dc43759cULL, 0x8ecba04d6bd24ae8ULL, 0xd7da2bc94459086aULL,
				0xa00dbd2fcceb5d5aULL, 0x0e6c31ea379cef08ULL, 0x868927453b2e7928ULL, 0xa49185dc2ed7b5c7ULL, 0xb92bf9c36c8596c0ULL, 0x1550e9ff0252297fULL, 0x89ad9b4ec85f6bedULL, 0xb2ec9e0409d2ee64ULL,
				0xf51b3089a4452f7dULL, 0xf98dcaee9fad2d38ULL, 0x5c6faa9ec9359b4eULL, 0xe9a245e5144dee7eULL, 0xb59adc1def5f82b1ULL, 0xd7013ab93cf82efeULL, 0x6d07d099ac5fa5f6ULL, 0xe4fa210fb70d0071ULL,
				0x53bcd2b49d2a1089ULL, 0x1e84cf5445226ed4ULL, 0x88b21a0050cb66ebULL, 0x7880745357823408ULL, 0x0da92356d526d551ULL, 0x64fd0b1926b05611ULL, 0x3537946f5801e5d4ULL, 0xebadb8808c7b8135ULL,
				0xfcd9c231a0c0b84dULL, 0x8e5c7af5f6998582ULL, 0x8bbf4cf1043ef643ULL, 0x1ad1434865f1443fULL, 0x1af01079c149f0f0ULL, 0xa9f698698e3640cfULL, 0xca37eadd2d2388efULL, 0xbd65c5225add2021ULL,
				0xe2dd5838aade46ecULL, 0xce77963291f3af40ULL, 0x53ba51d1e08d7100ULL, 0x214742e3aefeb82fULL, 0x9b5cdef47fdf9673ULL, 0x355635daf7974a8aULL, 0x10efc19e8dc0654bULL, 0xfabf9d1771f7fcd2ULL,
				0x46a1734840a1209aULL, 0xd12324ff7adfb8a9ULL, 0x8bb8b9ea5118c7f7ULL, 0x9e8e6e93deb22d6dULL, 0x1d2dfde5050a971cULL, 0x61b9948494b670f2ULL, 0x6ec2124516db1302ULL, 0x81e1468d2965ee4fULL,
			},
		},
	};

	uint64_t zobrist_castling[4] = {
		0xec70cf1b8574f9c8ULL, 0x50efff315b296a83ULL, 0x5e4a6c676b3feef1ULL, 0x3081ac6de56d836aULL
	};

	uint64_t zobrist_en_passant[64] = {
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
		0x0d307e30710bacf5ULL, 0xf5f9bc83a2c7ccf8ULL, 0xb288eeb33af6fe03ULL, 0xf270adbc89fe6085ULL, 0xc4b13a5abf7793faULL, 0x9937be5adb5d88dfULL, 0x242c4138a36024f2ULL, 0x8d4aaf2e2fc3d531ULL,
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
		0x3992bab403b0ce3cULL, 0x94247f7509921356ULL, 0x888122d9bf60acefULL, 0xb7939bdfed31f8adULL, 0xdc10b617ad36f480ULL, 0x31888881cd82c3a6ULL, 0x6aae56f6b9f55cafULL, 0xee056b89b4f9f70bULL,
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
		0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL
	};

	uint64_t zobrist_side_to_move = 0x8ad5774ee36ae569;



	void initialize_castling_mask();
	void set_piece_on_square(uint8_t square, PieceType piece, uint8_t side);
	bool set_piece_fen(char c, int sq);
public:
	 Bitboard P[6][2];

	 Bitboard all_pieces_types[2];
	 Bitboard all_pieces;


	 uint8_t castling_mask[64];

	uint8_t castling_rights;//bit 0 - white kingsite, bit 1 - white queensite, bit 2 - black kingsite, bit 3 - black queensite

	uint64_t zobrist_key;



	char number_of_pawns_on_files[2][8];//for each side, how many pawns on each file (a-h)

	int side_to_move;//0 - white, 1 - black
	int en_passant_square;
	int halfmove_clock;

	//std::vector<MoveRecord> moves_stack;


	MoveGenerator mg;

	StaticEvaluation se;

	uint64_t perft_nodes_searched;



	Board();

	void initialize_board();
	//void make_move(Move m);
	void make_move(Move move);
	void make_move(SimpleMove move, MoveType move_type);
	void undo_move();
	void update_all_pieces_bitboards();//sums up all piece bitboards into all_pieces_types and all_pieces
	bool load_fen(const std::string& fen);
	void calculate_zobrist_key();
	//PieceType opp_piece_on_square(int square);
	//bool is_move_legal(const Move& move);
	void perft(int depth);
	void initial_perft(int depth);
	void display_board(std::ostream& output);//debug only
	void display_board();//debug only



};